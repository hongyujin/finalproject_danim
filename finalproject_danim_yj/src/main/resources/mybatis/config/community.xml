<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="community">
	<resultMap type="communityVO" id="commRM">
		<result column="id" property="memberVO.id"/>
	</resultMap>
	
 	<select id="getCommlist" resultMap="commRM">
 		select comm_no,timePosted, content, likePosted,id from(
			select comm_no,timePosted, content, likePosted,id,ceil(rownum/#{value}) as page from (
				select comm_no,to_char(timePosted, 'mm-dd am hh:mi:ss') as timePosted, content, likePosted,id from community
				order by comm_no desc
			)
		)where page=1
 	</select>
 	
 	<insert id="registerComm" parameterType="communityVO">
 		<selectKey keyProperty="comm_no" order="BEFORE" resultType="int">
 			select comm_seq.nextval from dual 
 		</selectKey>
 		insert into community(comm_no,timePosted,content,id)
 		values(#{comm_no},sysdate,#{content},#{memberVO.id})
 	</insert>
</mapper>